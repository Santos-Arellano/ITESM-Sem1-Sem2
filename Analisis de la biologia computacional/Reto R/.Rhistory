install.packages("ggplot2")
install.packages("sequinr")
install.packages("seqine")
install.packages("seqinr")
library(seqinr)
library(ggplot2)
# Especies de coronavirus similares a SARS-CoV-2
especies <- c("batCoV_RaTG13", "batCoV_RmYN02", "batCoV_RaBtCoV/4991", "batCoV_RsYN06", "batCoV_RhGB01", "batCoV_Sl-CoVZC45", "batCoV_Sl-CoVZXC21", "batCoV_BtKY72", "batCoV_BtRsYN01", "batCoV_BtScCoV", "batCoV_SARSr-CoV", "pangolin_GX-P5E", "pangolin_GX-P4L", "pangolin_GD", "pangolin_HKU33", "civet_SARS-CoV", "human_SARS-CoV", "mink_SARS-CoV-2", "cat_SARS-CoV-2", "dog_SARS-CoV-2")
# Descargar las secuencias de la proteína Spike (S) de cada especie
secuencias <- sapply(especies, function(x) {
read.fasta(paste0("https://www.ncbi.nlm.nih.gov/sviewer/viewer.fcgi?id=", x, "&db=nuccore&report=fasta&extrafeat=null&fmt_mask=0&retmode=html&withmarkup=on&tool=portal&log$=seqview&maxdownloadsize=1000000"), seqtype = "DNA")
})
library(seqinr)
library(ggplot2)
# Especies de coronavirus similares a SARS-CoV-2
especies <- c("batCoV_RaTG13", "batCoV_RmYN02", "batCoV_RaBtCoV/4991", "batCoV_RsYN06", "batCoV_RhGB01", "batCoV_Sl-CoVZC45", "batCoV_Sl-CoVZXC21", "batCoV_BtKY72", "batCoV_BtRsYN01", "batCoV_BtScCoV", "batCoV_SARSr-CoV", "pangolin_GX-P5E", "pangolin_GX-P4L", "pangolin_GD", "pangolin_HKU33", "civet_SARS-CoV", "human_SARS-CoV", "mink_SARS-CoV-2", "cat_SARS-CoV-2", "dog_SARS-CoV-2")
# Descargar las secuencias de la proteína Spike (S) de cada especie
secuencias <- sapply(especies, function(x) {
read.fasta(paste0("https://www.ncbi.nlm.nih.gov/sviewer/viewer.fcgi?id=", x, "&db=nuccore&report=fasta&extrafeat=null&fmt_mask=0&retmode=html&withmarkup=on&tool=portal&log$=seqview&maxdownloadsize=1000000"), seqtype = "DNA")
})
help.search(qpe)
# Cargar paquetes
library(seqinr)
library(ggplot2)
# Obtener secuencias
virus <- c("MW133981", "MТ577009", "МТ835383", "MT890462", "МW056032","МТ470219", "МT594401","МWО30193","MТ810758", "МW041156", "MT324062", "MT994849","MT670013", "MT940481","МW134558", "МТ876433", "MT845878", "MT919790", "MT955161", "MT820489")
virus_secuencias <- read.GenBank(virus, as.character = TRUE)
install.packages("seqinr")
# Cargar paquetes
library(seqinr)
library(ggplot2)
# Obtener secuencias
virus <- c("MW133981", "MТ577009", "МТ835383", "MT890462", "МW056032","МТ470219", "МT594401","МWО30193","MТ810758", "МW041156", "MT324062", "MT994849","MT670013", "MT940481","МW134558", "МТ876433", "MT845878", "MT919790", "MT955161", "MT820489")
virus_secuencias <- read.GenBank(virus, as.character = TRUE)
# Cargar paquetes
install.packages("seqinr")
library(seqinr)
library(ggplot2)
# Obtener secuencias
virus <- c("MW133981", "MТ577009", "МТ835383", "MT890462", "МW056032","МТ470219", "МT594401","МWО30193","MТ810758", "МW041156", "MT324062", "MT994849","MT670013", "MT940481","МW134558", "МТ876433", "MT845878", "MT919790", "MT955161", "MT820489")
virus_secuencias <- read.GenBank(virus, as.character = TRUE)
install.packages("seqinr")
# Cargar paquetes
library(seqinr)
library(ggplot2)
# Obtener secuencias
virus <- c("MW133981", "MТ577009", "МТ835383", "MT890462", "МW056032","МТ470219", "МT594401","МWО30193","MТ810758", "МW041156", "MT324062", "MT994849","MT670013", "MT940481","МW134558", "МТ876433", "MT845878", "MT919790", "MT955161", "MT820489")
virus_secuencias <- read.GenBank(virus, as.character = TRUE)
install.packages("Biostrings")
virus <- с("MW133981", "MТ577009", "МТ835383", "MT890462", "МW056032","МТ470219", "МT594401","МWО30193","MТ810758", "МW041156", "MT324062", "MT994849","MT670013", "MT940481","МW134558", "МТ876433", "MT845878", "MT919790", "MT955161", "MT820489")
virus <- c("MW133981", "MТ577009", "МТ835383", "MT890462", "МW056032","МТ470219", "МT594401","МWО30193","MТ810758", "МW041156", "MT324062", "MT994849","MT670013", "MT940481","МW134558", "МТ876433", "MT845878", "MT919790", "MT955161", "MT820489")
virus_secuencias <- read.GenBank(virus, as.character=TRUE)
install.packages("ggplot2")
install.packages("seqinr")
library(seqin)
library(seqinr)
virus <- c("MW133981", "MТ577009", "МТ835383", "MT890462", "МW056032","МТ470219", "МT594401","МWО30193","MТ810758", "МW041156", "MT324062", "MT994849","MT670013", "MT940481","МW134558", "МТ876433", "MT845878", "MT919790", "MT955161", "MT820489")
virus_secuencias <- read.GenBank(virus, as.character=TRUE)
---
title: "Análisis de secuencias de coronavirus similares a SARS-CoV-2"
# Cargar librerías necesarias
library(seqinr)
library(ggplot2)
# Obtener las secuencias de los virus
virus <- c("MW133981", "MТ577009", "МТ835383", "MT890462", "МW056032","МТ470219", "МT594401","МWО30193","MТ810758", "МW041156", "MT324062", "MT994849","MT670013", "MT940481","МW134558", "МТ876433", "MT845878", "MT919790", "MT955161", "MT820489")
virus_secuencias <- read.GenBank(virus, as.character=TRUE)
#Este script debes de realizarlo en formato rmarkdown
install.packages("Rcpp")
install.packages("ape")
install.packages("maps")
#Este script debes de realizarlo en formato rmarkdown
install.packages("Rcpp")
install.packages("ape")
install.packages("maps")
install.packages("phangorn")
install.packages("phytools")
install.packages("geiger")
library("Rcpp")
library("maps")
library("ape")
library("phangorn")
library("phytools")
library("geiger")
## **El objeto `"phylo"` en R**
#Ahora hemos instalado paquetes críticos (ape, phangorn, phytools, geiger). El paquete principal más importante para las filogenias en R se llama "ape", que significa Analisis de Filogenetica y Evolucion en R. El paquete lo puedes consultar en:
library(ape)
text.string<- "(lemur,human);"
vert.tree<-read.tree(text=text.string)
plot(vert.tree,no.margin=TRUE,edge.width=2)
text.string<-
"(bat,(lemur,human));"
vert.tree<-read.tree(text=text.string)
plot(vert.tree,no.margin=TRUE,edge.width=2)
#1. Interpreta el resultado de la imagen anterior aquí:
text.string<-
"(((cow, pig),whale),(bat,(lemur,human)));"
vert.tree<-read.tree(text=text.string)
plot(vert.tree,no.margin=TRUE,edge.width=2)
#2. Interpreta el resultado de la imagen anterior aquí:
#Genera el codigo para siguiente Arbol: Esta es la manera de visualizar una imagen en formato .R
library(png)
library("Rcpp")
library("maps")
library("ape")
library("phangorn")
library("phytools")
library("geiger")
library(Biostrings)
library("Rcpp")
library("maps")
library("ape")
library("phangorn")
library("phytools")
library("geiger")
library("Biostrings")
# Cargar librerías necesarias
library(seqinr)
library(ggplot2)
# Obtener las secuencias de los virus
virus <- c("MW133981", "MТ577009", "МТ835383", "MT890462", "МW056032","МТ470219", "МT594401","МWО30193","MТ810758", "МW041156", "MT324062", "MT994849","MT670013", "MT940481","МW134558", "МТ876433", "MT845878", "MT919790", "MT955161", "MT820489")
virus_secuencias <- read.GenBank(virus, as.character=TRUE)
# Obtener la longitud de cada secuencia y crear un data.frame
longitudes <- c()
for (i in 1:length(virus_secuencias)) {
longitud <- length(virus_secuencias[[i]])
longitudes <- c(longitudes, longitud)
}
virus_df <- data.frame(Virus = virus, Longitud = longitudes)
# Crear un gráfico de barras para mostrar la longitud de cada secuencia
ggplot(virus_df, aes(x=Virus, y=Longitud)) +
geom_bar(stat="identity", fill="steelblue") +
xlab("Virus") + ylab("Longitud") +
ggtitle("Longitud de las secuencias de virus similares a SARS-CoV-2") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
# Cargar librerías necesarias
library(seqinr)
library(ggplot2)
# Obtener las secuencias de los virus
virus <- c("MW133981", "MТ577009", "МТ835383", "MT890462", "МW056032","МТ470219", "МT594401","МWО30193","MТ810758", "МW041156", "MT324062", "MT994849","MT670013", "MT940481","МW134558", "МТ876433", "MT845878", "MT919790", "MT955161", "MT820489")
virus_secuencias <- read.GenBank(virus, as.character=TRUE)
# Cargar librerías necesarias
library(seqinr)
library(ggplot2)
# Obtener las secuencias de los virus
virus <- c("MW133981", "MТ577009", "МТ835383", "MT890462", "МW056032","МТ470219", "МT594401","МWО30193","MТ810758", "МW041156", "MT324062", "MT994849","MT670013", "MT940481","МW134558", "МТ876433", "MT845878", "MT919790", "MT955161", "MT820489")
virus_secuencias <- read.GenBank(virus, as.character=TRUE)
# Cargar librerías necesarias
library(seqinr)
library(ggplot2)
# Obtener las secuencias de los virus
virus <- c("MW133981", "MТ577009", "МТ835383", "MT890462", "МW056032","МТ470219", "МT594401","МWО30193","MТ810758", "МW041156", "MT324062", "MT994849","MT670013", "MT940481","МW134558", "МТ876433", "MT845878", "MT919790", "MT955161", "MT820489")
virus_secuencias <- read.GenBank(virus, as.character=TRUE)
install.packages("seqinr")
# Cargar librerías necesarias
library(seqinr)
library(ggplot2)
# Obtener las secuencias de los virus
virus <- c("MW133981", "MТ577009", "МТ835383", "MT890462", "МW056032","МТ470219", "МT594401","МWО30193","MТ810758", "МW041156", "MT324062", "MT994849","MT670013", "MT940481","МW134558", "МТ876433", "MT845878", "MT919790", "MT955161", "MT820489")
virus_secuencias <- read.GenBank(virus, as.character=TRUE)
install.packages("seqinr")
# Cargar librerías necesarias
library(seqinr)
library(ggplot2)
# Obtener las secuencias de los virus
virus <- c("MW133981", "MТ577009", "МТ835383", "MT890462", "МW056032","МТ470219", "МT594401","МWО30193","MТ810758", "МW041156", "MT324062", "MT994849","MT670013", "MT940481","МW134558", "МТ876433", "MT845878", "MT919790", "MT955161", "MT820489")
virus_secuencias <- read.GenBank(virus, as.character=TRUE)
virus <- c("JX869059", "AY508724", "MN908947", "AY390556", "MN985325",
"NC_004718", "DQ497008", "AY291451", "AY395003", "AY395002",
"AY395000", "AY394996", "AY394995", "AY394992", "AY394983",
"AY394979", "AY304488", "AY502932", "AY394981", "AY304486")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
BiocManager::install("ggtree")
BiocManager::install("DECIPHER")
BiocManager::install("ggmsa")
installed.packages("adegenet")
install.packages("seqinr")
library(seqinr)
library(ape)
library(phytools)
library(Biostrings)
library(seqinr)
library(ggtree)
library(DECIPHER)
library(viridis)
library(ggplot2)
library(adegenet)
# Leer las secuencias de virus
virus_sequences <- seqinr::read.GenBank(virus)
virus <- c(  "JX869059", "AY508724", "MN908947", "AY390556", "MN985325","NC_004718","DQ497008","AY291451","AY395003","AY395002","AY395000","AY394996","AY394995","AY394992","AY394983", "AY394979","AY304488","AY502932","AY394981","AY304486")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
BiocManager::install("ggtree")
BiocManager::install("DECIPHER")
BiocManager::install("ggmsa")
installed.packages("adegenet")
install.packages("seqinr")
library(seqinr)
library(ape)
library(phytools)
library(Biostrings)
library(seqinr)
library(ggtree)
library(DECIPHER)
library(viridis)
library(ggplot2)
library(adegenet)
virus_sequences <- read.GenBank(virus)
intento <- read.GenBank("JX869059")
str(virus_sequences)
attributes(virus_sequences)
names(virus_sequences)
attr(virus_sequences, "species")
write.dna(virus_sequences,  file ="virus_seqs.fasta", format = "fasta", append =
FALSE, nbcol = 6, colsep = " ", colw = 10)
virus_seq_no_alineadas <- readDNAStringSet("virus_seqs.fasta", format = "fasta")
virus_seq_no_alineadas <- OrientNucleotides(virus_seq_no_alineadas)
virus_align_seqs <- AlignSeqs(virus_seq_no_alineadas)
virus <- c(  "JX869059", "AY508724", "MN908947", "AY390556", "MN985325","NC_004718","DQ497008","AY291451","AY395003","AY395002","AY395000","AY394996","AY394995","AY394992","AY394983", "AY394979","AY304488","AY502932","AY394981","AY304486")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
BiocManager::install("ggtree")
BiocManager::install("DECIPHER")
BiocManager::install("ggmsa")
installed.packages("adegenet")
install.packages("seqinr")
library(seqinr)
library(ape)
library(phytools)
library(Biostrings)
library(seqinr)
library(ggtree)
library(DECIPHER)
library(viridis)
library(ggplot2)
library(adegenet)
virus_sequences <- read.GenBank(virus)
intento <- read.GenBank("JX869059")
str(virus_sequences)
attributes(virus_sequences)
names(virus_sequences)
attr(virus_sequences, "species")
write.dna(virus_sequences,  file ="virus_seqs.fasta", format = "fasta", append =
FALSE, nbcol = 6, colsep = " ", colw = 10)
virus_seq_no_alineadas <- readDNAStringSet("virus_seqs.fasta", format = "fasta")
virus_seq_no_alineadas <- OrientNucleotides(virus_seq_no_alineadas)
virus_align_seqs <- AlignSeqs(virus_seq_no_alineadas)
writeXStringSet(virus_align_seqs, file = "virus_align_seq.fasta")
virus_aligned <- read.alignment("virus_align_seq.fasta", format = "fasta")
print("Longitudes")
for (i in 1:20) {
print(length(virus_sequences[[i]]))
}
setwd("C:/Users/JESUS BAÑALES/OneDrive/Documentos/Tec/Bio Comp/R/Evidencia2")
virus <- c(  "JX869059", "AY508724", "MN908947", "AY390556", "MN985325","NC_004718","DQ497008","AY291451","AY395003","AY395002","AY395000","AY394996","AY394995","AY394992","AY394983", "AY394979","AY304488","AY502932","AY394981","AY304486")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
BiocManager::install("ggtree")
BiocManager::install("DECIPHER")
BiocManager::install("ggmsa")
installed.packages("adegenet")
install.packages("seqinr")
library(seqinr)
library(ape)
library(phytools)
library(Biostrings)
library(seqinr)
library(ggtree)
library(DECIPHER)
library(viridis)
library(ggplot2)
library(adegenet)
virus_sequences <- read.GenBank(virus)
virus <- c(  "JX869059", "AY508724", "MN908947", "AY390556", "MN985325","NC_004718","DQ497008","AY291451","AY395003","AY395002","AY395000","AY394996","AY394995","AY394992","AY394983", "AY394979","AY304488","AY502932","AY394981","AY304486")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
BiocManager::install("ggtree")
BiocManager::install("DECIPHER")
BiocManager::install("ggmsa")
installed.packages("adegenet")
install.packages("seqinr")
library(seqinr)
library(ape)
library(phytools)
library(Biostrings)
library(seqinr)
library(ggtree)
library(DECIPHER)
library(viridis)
library(ggplot2)
library(adegenet)
virus_sequences <- read.GenBank(virus)
intento <- read.GenBank("JX869059")
str(virus_sequences)
attributes(virus_sequences)
names(virus_sequences)
attr(virus_sequences, "species")
write.dna(virus_sequences,  file ="virus_seqs.fasta", format = "fasta", append =
FALSE, nbcol = 6, colsep = " ", colw = 10)
virus_seq_no_alineadas <- readDNAStringSet("virus_seqs.fasta", format = "fasta")
virus_seq_no_alineadas <- OrientNucleotides(virus_seq_no_alineadas)
virus_align_seqs <- AlignSeqs(virus_seq_no_alineadas)
writeXStringSet(virus_align_seqs, file = "virus_align_seq.fasta")
virus_aligned <- read.alignment("virus_align_seq.fasta", format = "fasta")
print("Longitudes")
for (i in 1:20) {
print(length(virus_sequences[[i]]))
}
setwd("/Users/santosarellanoolarte/Downloads/Reto R")
SARS_COV2 <- read.fasta("virus_seqs.fasta")
compara <- function(seq1){
par(mfrow=c(1,4))
for (i in 1:20) {
barplot(table(seq1[i]), col=1:5)
}
}
compara(SARS_COV2)
matriz_distancia <- dist.alignment(virus_aligned, matrix = "similarity")
table.paint(temp, cleg=0, clabel.row=.5, clabel.col=.5) + scale_color_viridis()
# Identificadores de las secuencias de virus
virus <- c("NS-1", "Sino1-11", "GZ02", "GD01", "Wuhan-Hu-1", "2019-nCoV/USA-WA1/2020", "Tor2", "MA15", "TW1", "ZS-C", "LC5", "LC3", "ZS-B", "HSZ-Cc", "HZS2-C", "HSZ2-A", "GZ-C", "SZ16", "TW9", "HGZ8L1-A", "SZ3")
# Instalación de paquetes necesarios
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
BiocManager::install("ggtree")
BiocManager::install("DECIPHER")
BiocManager::install("ggmsa")
install.packages("seqinr")
# Carga de bibliotecas
library(seqinr)
library(ape)
library(phytools)
library(Biostrings)
library(ggtree)
library(DECIPHER)
library(viridis)
library(ggplot2)
library(adegenet)
```{r}
# Identificadores de las secuencias de virus
virus <- c("NS-1", "Sino1-11", "GZ02", "GD01", "Wuhan-Hu-1", "2019-nCoV/USA-WA1/2020", "Tor2", "MA15", "TW1", "ZS-C", "LC5", "LC3", "ZS-B", "HSZ-Cc", "HZS2-C", "HSZ2-A", "GZ-C", "SZ16", "TW9", "HGZ8L1-A", "SZ3")
# Instalación de paquetes necesarios
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
BiocManager::install("ggtree")
BiocManager::install("DECIPHER")
BiocManager::install("ggmsa")
install.packages("seqinr")
# Carga de bibliotecas
library(seqinr)
library(ape)
library(phytools)
library(Biostrings)
library(ggtree)
library(DECIPHER)
library(viridis)
library(ggplot2)
library(adegenet)
# Lectura de las secuencias de virus
virus_sequences <- read.GenBank(virus)
# Identificadores de las secuencias de virus
virus <- c("NS-1", "Sino1-11", "GZ02", "GD01", "Wuhan-Hu-1", "2019-nCoV/USA-WA1/2020", "Tor2", "MA15", "TW1", "ZS-C", "LC5", "LC3", "ZS-B", "HSZ-Cc", "HZS2-C", "HSZ2-A", "GZ-C", "SZ16", "TW9", "HGZ8L1-A", "SZ3")
# Instalación de paquetes necesarios
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
BiocManager::install("ggtree")
BiocManager::install("DECIPHER")
BiocManager::install("ggmsa")
install.packages("seqinr")
# Carga de bibliotecas
library(seqinr)
library(ape)
library(phytools)
library(Biostrings)
library(ggtree)
library(DECIPHER)
library(viridis)
library(ggplot2)
library(adegenet)
# Lectura de las secuencias de virus
virus_sequences <- read.GenBank(virus)
install.packages("seqinr")
virus <- c(  "JX869059", "AY508724", "MN908947", "AY390556", "MN985325","NC_004718","DQ497008","AY291451","AY395003","AY395002","AY395000","AY394996","AY394995","AY394992","AY394983", "AY394979","AY304488","AY502932","AY394981","AY304486")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
BiocManager::install("ggtree")
BiocManager::install("DECIPHER")
BiocManager::install("ggmsa")
installed.packages("adegenet")
install.packages("seqinr")
library(seqinr)
library(ape)
library(phytools)
library(Biostrings)
library(seqinr)
library(ggtree)
library(DECIPHER)
library(viridis)
library(ggplot2)
library(adegenet)
virus_sequences <- read.GenBank(virus)
intento <- read.GenBank("JX869059")
str(virus_sequences)
attributes(virus_sequences)
names(virus_sequences)
attr(virus_sequences, "species")
write.dna(virus_sequences,  file ="virus_seqs.fasta", format = "fasta", append =
FALSE, nbcol = 6, colsep = " ", colw = 10)
virus_seq_no_alineadas <- readDNAStringSet("virus_seqs.fasta", format = "fasta")
virus_seq_no_alineadas <- OrientNucleotides(virus_seq_no_alineadas)
virus_align_seqs <- AlignSeqs(virus_seq_no_alineadas)
writeXStringSet(virus_align_seqs, file = "virus_align_seq.fasta")
virus_aligned <- read.alignment("virus_align_seq.fasta", format = "fasta")
print("Longitudes")
for (i in 1:20) {
print(length(virus_sequences[[i]]))
}
setwd("/Users/santosarellanoolarte/Downloads/Reto R")
SARS_COV2 <- read.fasta("virus_seqs.fasta")
compara <- function(seq1){
par(mfrow=c(1,4))
for (i in 1:20) {
barplot(table(seq1[i]), col=1:5)
}
}
compara(SARS_COV2)
matriz_distancia <- dist.alignment(virus_aligned, matrix = "similarity")
virus_filogenetico <- nj(matriz_distancia)
virus_plot_filogenetico <- ladderize(virus_filogenetico)
plot_virus <- ggtree(virus_plot_filogenetico) + geom_tiplab()
plot_virus
virus <- c("JX869059", "AY508724", "MN908947", "AY390556", "MN985325", "NC_004718", "DQ497008", "AY291451", "AY395003", "AY395002", "AY395000", "AY394996", "AY394995", "AY394992", "AY394983", "AY394979", "AY304488", "AY502932", "AY394981", "AY304486")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
BiocManager::install("ggtree")
BiocManager::install("DECIPHER")
BiocManager::install("ggmsa")
installed.packages("adegenet")
install.packages("seqinr")
library(seqinr)
library(ape)
library(phytools)
library(Biostrings)
library(seqinr)
library(ggtree)
library(DECIPHER)
library(viridis)
library(ggplot2)
library(adegenet)
virus_sequences <- read.GenBank(virus)
intento <- read.GenBank("JX869059")
virus <- c("JX869059", "AY508724", "MN908947", "AY390556", "MN985325", "NC_004718", "DQ497008", "AY291451", "AY395003", "AY395002", "AY395000", "AY394996", "AY394995", "AY394992", "AY394983", "AY394979", "AY304488", "AY502932", "AY394981", "AY304486")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
BiocManager::install("ggtree")
BiocManager::install("DECIPHER")
BiocManager::install("ggmsa")
installed.packages("adegenet")
install.packages("seqinr")
library(seqinr)
library(ape)
library(phytools)
library(Biostrings)
library(seqinr)
library(ggtree)
library(DECIPHER)
library(viridis)
library(ggplot2)
library(adegenet)
virus_sequences <- read.GenBank(virus)
intento <- read.GenBank("JX869059")
str(virus_sequences)
attributes(virus_sequences)
names(virus_sequences)
attr(virus_sequences, "species")
write.dna(virus_sequences,  file ="virus_seqs.fasta", format = "fasta", append =
FALSE, nbcol = 6, colsep = " ", colw = 10)
virus_seq_no_alineadas <- readDNAStringSet("virus_seqs.fasta", format = "fasta")
virus_seq_no_alineadas <- OrientNucleotides(virus_seq_no_alineadas)
virus_align_seqs <- AlignSeqs(virus_seq_no_alineadas)
writeXStringSet(virus_align_seqs, file = "virus_align_seq.fasta")
virus_aligned <- read.alignment("virus_align_seq.fasta", format = "fasta")
print("Longitudes")
for (i in 1:20) {
print(length(virus_sequences[[i]]))
}
setwd("/Users/santosarellanoolarte/Downloads/Reto R")
SARS_COV2 <- read.fasta("virus_seqs.fasta")
compara <- function(seq1){
par(mfrow=c(1,4))
for (i in 1:20) {
barplot(table(seq1[i]), col=1:5)
}
}
compara(SARS_COV2)
matriz_distancia <- dist.alignment(virus_aligned, matrix = "similarity")
virus_filogenetico <- nj(matriz_distancia)
virus_plot_filogenetico <- ladderize(virus_filogenetico)
plot_virus <- ggtree(virus_plot_filogenetico) + geom_tiplab()
plot_virus
